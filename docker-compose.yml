# Docker Compose v2 ไม่จำเป็นต้องมี version
# (ใส่ไว้ก็ไม่พัง แต่เอาออกจะ clean กว่า)
# version: "3.8"

services:
  orchestrator:
    build:
      context: ./Orchestrator
      dockerfile: Dockerfile
    container_name: orchestrator
    ports:
      - "8080:80"
    environment:
      TECHNICAL_AGENT_URL: http://technical-agent:8002/analyze
      FUNDAMENTAL_AGENT_URL: http://fundamental-agent:8001/analyze
      DATABASE_AGENT_URL: http://database-agent:8003
    depends_on:
      - technical-agent
      - fundamental-agent
      - database-agent
    networks:
      - agent-network

  technical-agent:
    build:
      context: ./Technical_Agent
      dockerfile: Dockerfile
    container_name: technical-agent
    ports:
      - "8002:8002"
    networks:
      - agent-network

  fundamental-agent:
    build:
      context: ./Fundamental_Agent
      dockerfile: Dockerfile
    container_name: fundamental-agent
    ports:
      - "8001:8001"
    environment:
      GOOGLE_API_KEY: dummy-key
    networks:
      - agent-network

  database-agent:
    build:
      context: ./Database_Agent
      dockerfile: Dockerfile
    container_name: database-agent
    ports:
      - "8003:8003"
    networks:
      - agent-network

networks:
  agent-network:
    driver: bridge